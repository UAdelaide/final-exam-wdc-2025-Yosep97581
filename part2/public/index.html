<script>
const { createApp, ref } = Vue;
createApp({
  data() {
    return {
      message: 'Welcome to the Dog Walking Service!'
    };
  },
  setup() {
    const loginForm = ref({
      email: '',
      password: ''
    });

    async function login() {
      try {
        const res = await fetch('/api/users/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: loginForm.value.email, password: loginForm.value.password }),
          credentials: 'include' // keep session cookie
        });

        const result = await res.json();

        if (res.ok && result.user) {
          if (result.user.role === 'owner') {
            window.location.href = 'owner-dashboard.html';
          } else if (result.user.role === 'walker') {
            window.location.href = 'walker-dashboard.html';
          } else {
            alert('Unknown role');
          }
        } else {
          alert(result.error || 'Login failed');
        }

      } catch (err) {
        console.error('Login error:', err);
        alert('Server error');
      }
    }

    return {
      loginForm,
      login
    };
  }
}).mount('#app');
</script>
